<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>登录 - 买酒网-中国多快好省的白酒,红酒,洋酒,葡萄酒官方网站!</title>
    <link rel="icon" type="image/x-icon" href="http://www.mjwimg.com/images/system/config/website/favicon_0.ico">
    <link rel="shortcut icon" type="image/x-icon"
        href="http://www.mjwimg.com/images/system/config/website/favicon_0.ico">
    <link rel="stylesheet" href="assets/iconfont/iconfont.css" />
    <link rel="stylesheet" href="css/common.css" />
    <link rel="stylesheet" href="css/site.css" />
    <script src="js/jquery-1.11.3.js"></script>
    <script src="js/jquery.model.js"></script>
    <script src="js/cookie.js"></script>
    <script src="js/securityCode.js"></script>
    <script src="js/layer/layer.js"></script>
    <style type="text/css">
        .code {
            width: 100px;
            height: 38px;
            line-height: 35px;
            text-align: center;
            /* background-color: #808080; */
            background-image: url(images/code.jpg);
            display: inline-block;
            color: black;
            font-size: 17px;
            border-radius: 2px;
            margin-top: -3px;
            font-weight: 900;
        }
    </style>
</head>

<body>
    <div class="header login-header w990">
        <div class="logo-info">
            <a href="index.html" class="logo">
                <img src="http://www.mjwimg.com/images/system/config/mall/mall_logo_0.jpg">
            </a>
            <span class="findpw">欢迎登录</span>
        </div>
    </div>
    <div class="login-content">
        <div class="login-banner"
            style="background: url('http://www.mjwimg.com/images/system/config/login_bg/login_bg_image_0.jpg') center;">
            <div class="w990 pos-r">
                <link type="text/css" rel="stylesheet" href="http://www.maijiuwang.com/css/login.css">
                <div id="1568946169K3egMX" class="login-form">
                    <div class="login-con pos-r">
                        <div class="login-switch">
                            <a href="javascript:;" class="qrcode-target btn-qrcode" on-moblie="false"
                                title="手机扫码登录"></a>
                        </div>
                        <div class="login-wrap ">
                            <div class="login-tit">
                                还没有账号？
                                <a href="register/mobile.html" class="regist-link color">
                                    立即注册
                                    <i>&gt;</i>
                                </a>
                            </div>
                            <div class="login-radio">
                                <ul>
                                    <li class="active login-tab" id="login2" data-tab_id="2">普通登录</li>
                                </ul>
                            </div>
                            <!-- 普通登录 start -->
                            <div id="con_login_2" class="form">
                                <form id="form2">
                                    <div class="form-group item-name">
                                        <div class="form-control-box">
                                            <i class="icon"></i>
                                            <input type="text" id="username" value="" class="text" tabindex="1"
                                                placeholder="已验证手机/邮箱/用户名" autocomplete="off">
                                        </div>
                                        <span id="username-error" class="form-control-error"
                                            style="display: none;color: #E31939;"></span>
                                    </div>
                                    <div class="form-group item-password">
                                        <div class="form-control-box">
                                            <i class="icon"></i>
                                            <input type="password" id="userpwd" value="" class="text" tabindex="2"
                                                placeholder="密码" autocomplete="off">
                                        </div>
                                        <span id="userpwd-error" class="form-control-error"
                                            style="display: none;color: #E31939;"></span>
                                    </div>
                                    <div class="form-group form-group-spe captcha" id="o-authcode">
                                        <div class="form-control-box">
                                            <i class="icon"></i>
                                            <input type="text" id="captcha" class="text" tabindex="3" placeholder="验证码"
                                                maxlength="4">
                                            <label class="captcha"><span id="checkCode" class="code"
                                                    style="vertical-align: middle; cursor: pointer;"
                                                    onclick="createCode(4)"></span></label>
                                        </div>
                                        <span id="checkCode-error" class="form-control-error"
                                            style="display: none;color: #E31939;"></span>
                                    </div>
                                    <div class="safety">
                                        <label for="LoginModel[rememberMe]">
                                            <input type="checkbox" value="1" id="LoginModel[rememberMe]"
                                                class="checkbox">
                                            <span>自动登录</span>
                                        </label>
                                        <a class="forget-password fr" href="javascript:void(0)">忘记密码？</a>
                                    </div>
                                    <div class="login-btn">
                                        <input type="button" id="btn_submit" class="btn-img btn-entry bg-color"
                                            value="立即登录">
                                    </div>
                                </form>
                            </div>
                            <!-- 普通登录 end -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="login-footer">
        <!-- 底部 _start-->
        <div id="links" class="links-box w1210"></div>
        <div class="site-footer">
            <div class="footer-related">
                <div class="footer-info">
                    <div class="info-text">
                        <!-- 底部导航 -->
                        <p class="nav-bottom">
                            <a href="index.html" target="_blank">首页</a>
                            <em>|</em>
                            <a href="javascript:void(0)" target="_blank">分类</a>
                            <em>|</em>
                            <a href="javascript:void(0)" target="_blank">清单</a>
                            <em>|</em>
                            <a href="shoppingcar.html" target="_blank">购物车</a>
                            <em>|</em>
                            <a href="javascript:void(0)" target="_blank">我的</a>
                        </p>
                        <p>
                            买酒网（北京）电子商务有限公司(www.maijiuwang.com) 版权所有
                            <a href="javascript:void(0)" target="_blank">京ICP备16061833号-1</a>
                        </p>
                        <p class="company-info" style="display: none;">玉泉营北京111文化产业园</p>
                        <p class="qualified">
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- 底部 _end-->
    </div>
</body>
<script>
    $("#links").load("layout/links.html");
    //页面加载时，生成随机验证码
    window.onload = function () {
        createCode(4);
    }

    $("#btn_submit").click(function () {
        if (!checkUserName()) {
            return false;
        }
        if (!checkUserPwd()) {
            return false;
        }
        if (!checkCode()) {
            return false;
        }
        if (checkUserName() && checkUserPwd() && checkCode()) {
            $.ajax({
                type: "get",
                url: "php/userlogin.php",
                data: {
                    username: $("#username").val(),
                    userpwd: $("#userpwd").val()
                },
                datatype: "json",
                success: function (result) {
                    var obj = eval('(' + result + ')');
                    if (obj.code == 1) {
                        setCookie("loginId", obj.id);
                        setCookie("loginName", $("#username").val());
                        var backUrl = getCookie("backUrl");
                        if (backUrl) {
                            window.location.href = backUrl;
                        } else {
                            window.location.href = "index.html";
                        }
                    } else if (obj.code == -1) {
                        layer.alert(obj.msg, {
                            skin: 'layui-layer-lan',
                            closeBtn: 0
                        }, function () {
                            window.location.href = "register/mobile.html";
                        });
                    } else {
                        layer.alert(obj.msg, {
                            skin: 'layui-layer-lan',
                            closeBtn: 0
                        });
                        createCode(4);
                        $("#captcha").val("");
                    }
                }
            });
        }
    });

    /*用户名验证*/
    function checkUserName() {
        var username = $("#username").val();
        if (username == "") {
            $("#username-error").html("请输入用户名").css("display", "");
            return false;
        }
        return true;
    }

    /*密码验证*/
    function checkUserPwd() {
        var userpwd = $("#userpwd").val();
        if (userpwd == "") {
            $("#userpwd-error").html("请输入密码").css("display", "");
            return false;
        }
        return true;
    }

    /*验证码验证*/
    function checkCode() {
        var captcha = $("#captcha").val();
        if (captcha == "") {
            $("#checkCode-error").html("请输入验证码").css("display", "");
            return false;
        }
        var checkCode = getCookie("verificationCode");
        if (checkCode.toLocaleLowerCase() != captcha.toLocaleLowerCase()) {
            $("#checkCode-error").html("验证码错误,请重新输入").css("display", "");
            createCode(4);
            return false;
        }
        $("#checkCode-error").html("").css("display", "none");
        return true;
    }
</script>

</html>